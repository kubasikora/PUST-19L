\chapter{Dobieranie nastawów regulatorów PID}
\label{zad5}

\section{Strojenie regulatora PID}
\label{zad5_PID_wykresy}
W celu dobrania optymalnych parametrów regulatora, wyszliśmy od parametrów uzyskanych metodą
Zieglera-Nicholsa a następnie ręcznie dostroiliśmy poszczególne parametry tak aby uzyskać
jak najlepszy efekty końcowy. Eksperyment ten polegał na znalezieniu takiego wzmocnienia $K_{r}$, 
zwanego wzmocnieniem krytycznym, dla którego obiekt wpadał w niegasnące oscylacje o okresie $T_{k}$. 

Cały proces dobierania parametrów składał się z następujących kroków:
\begin{center}
\begin{enumerate}
    \item Wyznaczenie wzmocnienia $K_{\mathrm{k}}$ i okresu oscylacji $T_{\mathrm{k}}$
    \item Wyliczenie parametrów regulatora
    \item Ręczna poprawa wartości wzmocnienia członu proporcjonalnego $K_{\mathrm{r}}$
    \item Ręczna poprawa wartości parametru członu całkującego $T_{\mathrm{i}}$
    \item Ręczna poprawa wartości parametru członu różniczkującego $T_{\mathrm{d}}$
\end{enumerate}
\end{center}

Chcąc znaleźć jeszcze lepsze nastawy regulatora, po wyznaczeniu parametrów za pomocą metody Zieglera-Nicholsa, zastosowaliśmy metodę eksperymentalną. W której jakość regulacji ocenialiśmy jakościowo (na podstawie przebiegów sygnałów na wykresach) oraz ilościowo, za pomocą wskaźnika jakości regulacji danego wzorem:
\begin{equation}
E=\sum_{k=0}^{K_{konc}}(y^{zad}[k]-y[k])^{2}
\end{equation}


\subsection{Wyznaczenie wzmocnienia $K_{\mathrm{k}}$ i okresu oscylacji $T_{\mathrm{k}}$}
\label{zad5_wyznaczanie_parametrow_zn}
Na początku doprowadziliśmy układ do granicy stabilności, czyli momentu
w którym zaczęły pojawiać się niegasnące oscylacje. Zrealizowaliśmy to
zwiększając współczynnik wzmocnienia $K_{\mathrm{r}}$ przy wyłączonych członach 
całkującym i różniczkującym. Iteracyjnie wyznaczaliśmy nowe wartości wzmocnienia,
zwiększając jego wartość w przypadku gasnących oscylacji oraz zmniejszając w przypadku
niestabilnej odpowiedzi obiektu.

Gdy ostatecznie zaobserwowaliśmy niegasnące oscylacje zapisaliśmy aktualne wzmocnienie 
jako wzmocnienie krytyczne $K_{k}$ i zmierzyliśmy okres oscylacji drgań 
krytycznych $T_{k}$ ($K_{k} = 1,8 \hspace{0.3 cm} T_{k}=18,5 $). Wiedząc że okres próbkowania procesu 
wynosi $\num{0,5}s$, a zmierzony okres oscylacji wynosił $\num{37}$ próbek, wyliczyliśmy że
okres drgań krytycznych równa się $T_{k}=18,5s$. 

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.7, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0, 100, 200, 300, 400, 500},
    %ytick={3.9, 4, 4.1, 4.2, 4.3, 4.4},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/zad5_PID_setpoint_exampleK_1.8_Ti_1000000000000_Td_0.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/zad5_PID_output_exampleK_1.8_Ti_1000000000000_Td_0.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Niegasnące oscylacje wyjścia obiektu przy wzmocnieniu krytycznym}
    \label{zad5_niegasnace_oscylacje}
\end{figure}

\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=0.25, ymax=0.75,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/zad5_PID_input_exampleK_1.8_Ti_1000000000000_Td_0.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego }
    \label{zad5_niegasnace_oscylacje_ster}
\end{figure}
\FloatBarrier

\subsection{Wyliczenie wstępnych parametrów regulatora}
\label{zad5_regulator_zn}
Dobierając nastawy według metody Zieglera-Nicholsa, 
stosowaliśmy wzory do obliczenia parametrów regulatora PID: 

\begin{equation}
\label{zad5_zn_wzory}
K_{\mathrm{r}}=\num{0,6}K_{\mathrm{k}}; \hspace{0.5 cm} T_{\mathrm{i}}=\num{0,5} \hspace{0.5 cm} T_{\mathrm{k}}; T_{\mathrm{d}}=\num{0,12} T_{\mathrm{k}}
\end{equation}
gdzie:
\begin{center}
\begin{itemize}
    \item $K_{\mathrm{k}}$ - wzmocnienie krytyczne
    \item $T_{\mathrm{k}}$ - okres oscylacji
\end{itemize}
\end{center}

Wyliczone wartości liczbowe parametrów:
\begin{center}
$K_{r}=\num{1,08} \hspace{0.5 cm}
T_{i}=\num{9,25}   \hspace{0.5 cm}
T_{d}=\num{2,22}$
\end{center}

Regulator z parametrami wyznaczonymi przy pomocy metody opisanej przez panów Johna Zieglera
i Nathaniela Nicholsa, nadal charakteryzuje się niegasnącymi oscylacjami. Takie 
przebiegi sygnałów są nieakceptowalne, dlatego w dalszych krokach ręcznie modyfikowaliśmy 
wartości parametrów. 

Na rysunku \ref{zad5_zn_regulator} przedstawiono przebiegu wartości zadanej oraz
wyjścia obiektu z widocznie przedstawionymi oscylacjami wokół wartości zadanej.
Rysunek \ref{zad5_zn_sterowanie} przedstawia zmianę sygnału sterującego
generowanego przez regulator.

Tak nastrojony regulator PID bardzo słabo radzi sobie z utrzymywaniem sygnału wyjściowego
procesu na poziomie wartości zadanej. Niegasnące oscylacje nie pozwalają na zastosowanie
tego zestawu parametrów do regulacji procesem. Dla zadanej trajektorii testowej, obliczony 
wskaźnik jakości regulacji wyniósł $E = \num{5,8385}$. Pomimo swoich wad, regulator ten jest 
dobrym punktem wyjścia dla metody eksperymentalnej.

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=600,ymin=3.7, ymax=4.4,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/zad5_multiplejumps/zad5_PID_setpoint_exampleK_1.08_Ti_9.25_Td_2.22_E_5.8385.csv};
    \addplot[red, semithick] file{../data/zad5_multiplejumps/zad5_PID_output_exampleK_1.08_Ti_9.25_Td_2.22_E_5.8385.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg procesu sterowanego za pomocą regulatora z parametrami wyznaczonymi za pomocą metody Zieglera-Nicholsa}
    \label{zad5_zn_regulator}
\end{figure}

\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.3, xmax= 600,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/zad5_multiplejumps/zad5_PID_input_exampleK_1.08_Ti_9.25_Td_2.22_E_5.8385.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora z parametrami wyznaczonymi za pomocą metody Zieglera-Nicholsa}
    \label{zad5_zn_sterowanie}
\end{figure}
\FloatBarrier




\subsection{Ręczna poprawa wartości wzmocnienia członu proporcjonalnego $K_{\mathrm{r}}$ }
\label{zad5_poprawa_Kr}
\subsubsection{Wzmocnienie regulatora $K_{r}=0,75$}
W pierwszej kolejności skupiliśmy się na zmianie parametru $K_{\mathrm{r}}$.
Zmniejszenie $K_{\mathrm{r}}$ do wartości $\num{0.75}$ sprawiło że pozbyliśmy się oscylacji. Czas regulacji
wyniósł około 100 próbek. Dodatkowo, sygnał wyjściowy procesu nie cechuje się przeregulowaniem,
czyli przekroczenie wartości zadanej. Wyjście obiektu już nie oscyluje tak jak to było w przypadku regulatora z \ref{zad5_regulator_zn},
jak i została przywrócona stabilność procesu. Sygnał sterujący cechuje się oscylacjami przy zmianach
wartości zadanej, co powoduje nierówny przebieg wyjścia procesu.
Wartość wskaźnika jakości regulacji dla tego regulatora przy tej samej
testowej trajektorii zadanej wyniosła $E=\num{5,6914}$, co jest niewielką poprawą w stosunku 
do bazowego regulatora.
Przebiegi sygnału wyjściowego jaki i sygnału sterującego, odbiegały od pożądanych.

Wykres \ref{zad5_1_K_odp} przedstawia przebiegi wyjścia procesu oraz trajektorii zadanej.
Na rysunku \ref{zad5_1_zmiana_K} przedstawiliśmy przebieg sygnału sterującego generowanego przez regulator.

\subsubsection{Wzmocnienie regulatora $K_{r}=0,6$}
Zmniejszenie $K_{\mathrm{r}}$ do poziomu $\num{0,6}$ spowodowało wizualną poprawę odpowiedzi układu 
na zmianę wartości zadanej. Przebieg sygnału wyjściowego wygładził się, proces w łagodniejszy sposób
dociera do wartości zadanej. Czas regulacji niie zmienił się w porównaniu do poprzedniego regulatora.
Przebieg sygnału sterującego również uległ wygładzeniu, chociaż oscylacje nie zniknęły w całości.
Wartość wskaźnika jakości regulacji dla tego 
przypadku wyniosła $E=\num{6.1449}$, co zaskakująco, jest wartością większą w porównaniu do poprzedniego 
$K_{\mathrm{r}}$ regulatora. Łagodniejszy przebieg wyjścia powoduje zwiększenie sumy kwadratów uchybu.

Wykres \ref{zad5_2_K_odp} przedstawia przebiegi wyjścia procesu oraz trajektorii zadanej.
Na rysunku \ref{zad5_2_zmiana_K} przedstawiliśmy przebieg sygnału sterującego generowanego przez regulator.

\subsubsection{Wzmocnienie regulatora $K_{r}=0,5$}
Na wykresach \ref{zad5_3_K_odp} i \ref{zad5_3_zmiana_K} przedstawiono przebiegi powstałe 
dla regulatora z wzmocnieniem $ K_{\mathrm{r}} = \num{0,5}$. Sygnał sterujący praktycznie nie
oscyluje, natomiast sygnał wyjściowy ma jeszcze bardziej łagodny przebieg przez co czas regulacji 
nieznacznie wzrósł. Niestety wskaźnik jakości 
regulacji wzrósł do wartości $E=\num{6,5814}$. Zauważyliśmy że jego wartość rośnie przy zmniejszaniu  
parametru $ K_{\mathrm{r}}$, dlatego postanowiliśmy 
ostatecznie przyjąć wartość $K_{\mathrm{r}} = \num{0,5}$ i przejść do manipulowania 
pozostałymi parametrami. Dalsze zmniejszanie nie spowoduje 
znaczącej poprawy przebiegów sygnału a jedynie pogorszy wskaźnik jakości regulacji. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% wykresy dla k = 0.75

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=600,ymin=3.9, ymax=4.4,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_setpoint_exampleK_0.75_Ti_9.25_Td_2.22_E_5.6914.csv};
    \addplot[red, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_output_exampleK_0.75_Ti_9.25_Td_2.22_E_5.6914.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg procesu sterowanego za pomocą regulatora z 
    parametrami \mbox{$K_{r} = \num{0,75}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_1_K_odp}
\end{figure}

\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0, ymin=0.44, xmax=600, ymax=0.68,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_input_exampleK_0.75_Ti_9.25_Td_2.22_E_5.6914.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego generowanego przez regulator z 
    parametrami \mbox{$K_{r} = \num{0,75}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_1_zmiana_K}
\end{figure}
\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%% wykresy dla k = 0.6


\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=600,ymin=3.9, ymax=4.4,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_setpoint_exampleK_0.6_Ti_9.25_Td_2.22_E_6.1449.csv};
    \addplot[red, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_output_exampleK_0.6_Ti_9.25_Td_2.22_E_6.1449.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg procesu sterowanego za pomocą regulatora z 
    parametrami \mbox{$K_{r} = \num{0,6}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_2_K_odp}
\end{figure}

\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.44, xmax=600, ymax=0.68,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_input_exampleK_0.6_Ti_9.25_Td_2.22_E_6.1449.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego generowanego przez regulator z 
    parametrami \mbox{$K_{r} = \num{0,6}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_2_zmiana_K}
\end{figure}
\FloatBarrier

%%%%%%%%%%%%%%%%%%%%%% wykresy dla k = 0.5

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_setpoint_exampleK_0.5_Ti_9.25_Td_2.22_E_6.5814.csv};
    \addplot[red, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_output_exampleK_0.5_Ti_9.25_Td_2.22_E_6.5814.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg procesu sterowanego za pomocą regulatora z 
    parametrami \mbox{$K_{r} = \num{0,5}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_3_K_odp}
\end{figure}

\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/zad5_multiplejumps/P/zad5_PID_input_exampleK_0.5_Ti_9.25_Td_2.22_E_6.5814.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego generowanego przez regulator z 
    parametrami \mbox{$K_{r} = \num{0,5}$; $T_{i} = \num{9,25}$; $T_{d} = \num{2,22}$}}
    \label{zad5_3_zmiana_K}
\end{figure}
\FloatBarrier







\iffalse
\subsection{Ręczna poprawa wartości wzmocnienia członu całkującego $T_{\mathrm{i}}$ }
\indent 1. Człon całkujący zminiejszyliśmy o 1 
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_setpoint_exampleK_0.5_Ti_8.25_Td_2.22_E_1.1833.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_output_exampleK_0.5_Ti_8.25_Td_2.22_E_1.1833.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_1_Ti_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_input_exampleK_0.5_Ti_8.25_Td_2.22_E_1.1833.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_1_zmiana_Ti}
\end{figure}
\FloatBarrier

\indent 2.
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_setpoint_exampleK_0.5_Ti_7.25_Td_2.22_E_1.1138.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_output_exampleK_0.5_Ti_7.25_Td_2.22_E_1.1138.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_2_Ti_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_input_exampleK_0.5_Ti_7.25_Td_2.22_E_1.1138.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_2_zmiana_Ti}
\end{figure}
\FloatBarrier

\indent 3.
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_setpoint_exampleK_0.5_Ti_6.25_Td_2.22_E_1.0548.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_output_exampleK_0.5_Ti_6.25_Td_2.22_E_1.0548.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_3_Ti_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Ti/zad5_PID_input_exampleK_0.5_Ti_6.25_Td_2.22_E_1.0548.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_3_zmiana_Ti}
\end{figure}
\FloatBarrier

\subsection{Ręczna poprawa wartości wzmocnienia członu całkującego $T_{\mathrm{d}}$ }
\indent 1. Człon całkujący zminiejszyliśmy o 1 
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_setpoint_exampleK_0.5_Ti_7.25_Td_1.86_E_1.1087.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_output_exampleK_0.5_Ti_7.25_Td_1.86_E_1.1087.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_1_Td_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_input_exampleK_0.5_Ti_7.25_Td_1.86_E_1.1087.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_1_zmiana_Td}
\end{figure}
\FloatBarrier

\indent 2.
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_setpoint_exampleK_0.5_Ti_7.25_Td_1.62_E_1.1056.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_output_exampleK_0.5_Ti_7.25_Td_1.62_E_1.1056.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_2_Td_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_input_exampleK_0.5_Ti_7.25_Td_1.62_E_1.1056.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_2_zmiana_Td}
\end{figure}
\FloatBarrier

\indent 3.
\begin{figure}[b]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0,xmax=500,ymin=3.9, ymax=4.3,
    xlabel={$k$},
    ylabel={$y[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_setpoint_exampleK_0.5_Ti_7.25_Td_1.26_E_1.1015.csv};
    \addplot[red, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_output_exampleK_0.5_Ti_7.25_Td_1.26_E_1.1015.csv};
    \addlegendentry{$y^{zad}[k]$},
    \addlegendentry{$y[k]$},
    \addlegendimage{no markers, blue}
	\addlegendimage{no markers, red}
    \end{axis}
    \end{tikzpicture}
    \caption{Odpowiedź układu na skok wartości zadanej}
    \label{zad5_3_Td_odp}
\end{figure}

\begin{figure}[t]
    \centering
    \begin{tikzpicture}
    \begin{axis}[
    width=0.98\textwidth,
    xmin=0.0,ymin=0.45, xmax= 500,
    xlabel={$k$},
    ylabel={$u[k]$},
    %xtick={0.3, 0.4, 0.5, 0.6, 0.7},
    %ytick={3.5, 3.75, 4, 4.25, 4.5},
    legend pos=south east,
    y tick label style={/pgf/number format/1000 sep=},
    ]
    \addplot[const plot, blue, semithick] file{../data/Zad5_figure_data/Zmiany_na_Td/zad5_PID_input_exampleK_0.5_Ti_7.25_Td_1.26_E_1.1015.csv};
    \legend{$u[k]$}
    \end{axis}
    \end{tikzpicture}
    \caption{Przebieg sygnału sterującego regulatora}
    \label{zad5_3_zmiana_Td}
\end{figure}
\FloatBarrier
\fi