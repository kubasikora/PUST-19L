\subsection{Konfiguracja ze zmienionym wejściem niesterowanym}
\label{pro_pid_konf2}

Wykonaliśmy kolejną próbę strojenia wielowymiarowego regulatora PID 
z binarną macierzą połączeń, z tą różnicą że w tej próbie spróbowaliśmy 
wykorzystać poprzednio niesterowane wejście drugie. Wejście to cechuje się 
najbardziej porównywalnymi wzmocnieniami, tak jak to widać na \ref{pro2_odp_wyj_2}.
Ostatecznie zdecydowaliśmy się na następującą strukturę układu regulacji:

\begin{itemize}
    \item uchyb wyjścia pierwszego wchodzi na wejście pierwsze
    \item uchyb wyjścia drugiego wchodzi na wejście trzecie
    \item uchyb wyjścia trzeciego wchodzi na wejście drugie
    \item wejście czwarte pozostaje niesterowane
\end{itemize}

\noindent Macierz połączeń w tym przypadku miała postać: \\

\[
C =
\begin{bmatrix}
    1 & 0 & 0 \\
    0 & 0 & 1 \\
    0 & 1 & 0 \\
    0 & 0 & 0 
\end{bmatrix}
\]

W pierwszej kolejności, podobnie jak w poprzednim przypadku, sprawdziliśmy 
jakość układu regulacji przy sterowaniu regulatorami typu P o wzmocnieniu 
jednostkowym. 

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{1}}_{\mathrm{i}} = \infty$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{3}}_{\mathrm{i}} = \infty$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

W wyniku symulacji otrzymaliśmy następujące wskaźniki jakości:

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{30.151} \\
    \num{141.56} \\
    \num{81.328}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości, liczony jako suma wskaźników składowych, 
wyniósł $\bar{E} = \num{253.04}$\\

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_konf2_out1}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_wzmocnienia_jednostkowe/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_konf2_in1}
\end{figure}
\FloatBarrier

W następnym kroku spróbowaliśmy dołączyć człon całkujący, równocześnie 
dobierając wzmocnienie. Ostatecznie otrzymaliśmy następujący zestaw parametrów:

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{1}}_{\mathrm{i}} = \num{10.0}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{5.0}$, $T^{\num{2}}_{\mathrm{i}} = \num{10.0}$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{8.0}$, $T^{\num{3}}_{\mathrm{i}} = \num{10.0}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

dla których, w wyniku symulacji, uzyksaliśmy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{5.6968} \\
    \num{2.0091} \\
    \num{2.6499}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości dla tego regulatora wyniósł $\bar{E} = \num{10.356}$\\

Dodanie członu całkującego znacznie poprawiło jakość regulacji. Już w tym kroku udało się 
uzyskać jakość regulacji porównywalną z regulatorem uzyskanym w drodze 
optymalizacji omawianym w \ref{pro_pid_konf1}. Piki sygnałów wyjściowych procesu zostały 
zminimalizowane, choć widać że istnieje jeszcze możliwość poprawy, szczególnie w przypadku
wyjścia pierwszego.

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_konf2_out2}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Ti/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_konf2_in2}
\end{figure}
\FloatBarrier

W kolejnej iteracji sprawdziliśmy czy można jeszcze bardziej poprawić jakość
regulacji poprzez dodanie członu różniczkującego. W przypadku tego obiektu,
człon różniczkujący miał bardzo duży wpływ destabilizujący, dlatego ostatecznie
wartość parametrów $T_{\mathrm{d}}$ dla każdego z regulatora była bardzo mała.

Przedstawioną poniżej symulację wykonaliśmy dla następującego zestawu parametrów:

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{1}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.01}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{5.0}$, $T^{\num{2}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{2}}_{\mathrm{d}} = \num{0.01}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{8.0}$, $T^{\num{3}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.01}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

dla których, w wyniku symulacji, uzyksaliśmy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{3.6161} \\
    \num{2.1388} \\
    \num{2.4047}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości dla tego regulatora wyniósł $\bar{E} = \num{8.1595}$\\

W wyniku tej symulacji uzyskaliśmy dotychczas najniższy sumaryczny wskaźnik jakości regulacji, 
mimo to na przebiegach wyjścia pierwszego można zauważyć że postać tego przebiegu nie jest 
idealna. 

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_konf2_out2}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_dodanie_Td/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_konf2_in2}
\end{figure}
\FloatBarrier

\subsubsection{Optymalizacja parametrów regulatora}

W ostatniej próbie postanowiliśmy spróbować dobrać parametry wielowymiarowego 
regulatora metodą optymalizacyjną. Podobnie jak w przypadku poprzedniej konfiguracji,
wykorzystaliśmy skrypt \verb+pid_optim.m+. W wyniku procesu optymalizacji uzyskaliśmy następujący
zestaw parametrów:

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.658}$, $T^{\num{1}}_{\mathrm{i}} = \num{2.2035}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{4.2239}$, $T^{\num{2}}_{\mathrm{i}} = \num{2.9137}$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{7.2464}$, $T^{\num{3}}_{\mathrm{i}} = \num{6.802}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

dla których, w wyniku symulacji, uzyksaliśmy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{2.5296} \\
    \num{2.2543} \\
    \num{2.1545}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości dla tego regulatora wyniósł $\bar{E} = \num{6.9384}$\\

Zgodnie z oczekiwaniami, regulator otrzymany w wyniku optymalizacji okazał się najlepszy z wszystkich
rozważanych dla tej struktury. Co więcej, ten regulator jest lepszy od najlepszego regulatora uzyskanego
dla poprzednio rozważanej struktury.

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/konf2_pid_optim/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_pid_optim/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf2_pid_optim/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_konf2_out2}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf2_pid_optim/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_konf2_in2}
\end{figure}
\FloatBarrier