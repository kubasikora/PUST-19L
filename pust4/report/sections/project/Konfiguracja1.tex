\subsection{Konfiguracja z najmocniejszymi wzmocnieniami}
\label{pro_pid_konf1}

Analizując odpowiedzi na poszczególne skoki sygnałów wejściowych, zdecydowaliśmy się
sprawdzić konfigurację wejść i wyjść w której:\\

\begin{itemize}
    \item uchyb wyjścia pierwszego wchodzi na wejście pierwsze
    \item uchyb wyjścia drugiego wchodzi na wejście trzecie
    \item uchyb wyjścia trzeciego wchodzi na wejście czwarte
    \item wejście drugie pozostaje niesterowane
\end{itemize}

\noindent Macierz połączeń w tym przypadku miała postać: \\

\[
C =
\begin{bmatrix}
    1 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 1 
\end{bmatrix}
\]

W pierwszej kolejności sprawdziliśmy jak układ regulacji zachowa się w 
sytuacji gdy proces będzie sterowany regulatorami typu P o wzmocnieniu 
jednostkowym.

\begin{center}
$K^{\num{1}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{1}}_{\mathrm{i}} = \infty$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
$K^{\num{2}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
$K^{\num{3}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{3}}_{\mathrm{i}} = \infty$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
$K^{\num{4}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_2_out}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/konf1_wzmocnienia_jednostkowe/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_2_in}
\end{figure}
\FloatBarrier

Algorytm regulacji z tak dobranymi parametrami średnio radzi sobie z 
regulacją badanego obiektu. Wynika to z faktu błędnego dobrania parametrów 
regulatora oraz braku sterowania jednego z wejść. Wskaźniki jakości liczone względem 
każdego z wyjść wyniosły: 

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{31.462} \\
    \num{151.32} \\
    \num{89.142}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości, liczony jako suma wskaźników składowych, 
wyniósł $\bar{E} = \num{271.92}$\\

\vspace{2cm}

W kolejnej próbie zdecydowaliśmy sie na zwiększenie parametrów $K^{i}_{\mathrm{p}}$, tak aby
lepiej wspomagały wzmocnienia obsługiwanych torów sterowania. Zdecydowaliśmy się na następujący
zestaw parametrów 

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{3.0}$, $T^{\num{1}}_{\mathrm{i}} = \infty$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{2.0}$, $T^{\num{3}}_{\mathrm{i}} = \infty$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{4.0}$, $T^{\num{4}}_{\mathrm{i}} = \infty$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

Zwiększone parametry $K^{i}_{\mathrm{p}}$ pozwoliły na znaczne polepszenie jakości regulacji
omawianego procesu. Bardziej indywidualny dobór wzmocnień pozwolił na zmniejszenie uchybów 
poszczególnych wyjść, co pokazują odpowiednie wskaźniki jakości. 

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{7.03} \\
    \num{65.827} \\
    \num{14.685}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości regulacji wyniósł $\bar{E} = \num{87.541}$, co jest 
olbrzymią poprawą w stosunku do poprzednio rozważanego regulatora. Regulator ten niestety
nie może zostać uznany za dobry, ponieważ cechuje się bardzo dużymi skokami wartości wyjść 
procesu. 

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/wieksze_Kp/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/wieksze_Kp/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/wieksze_Kp/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_2_out}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/wieksze_Kp/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}
    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_2_in}
\end{figure}
\FloatBarrier

Problem dużych pików wyjścia postanowiliśmy rozwiązać poprzez uruchomienie członu 
całkującego. Po iteracyjnym procesie dobierania parametrów udało nam się uzyskać następujące
rezultaty.\\

Dla parametrów: \\
\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{2.0}$, $T^{\num{1}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{7.0}$, $T^{\num{3}}_{\mathrm{i}} = \num{12.0}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{4.0}$, $T^{\num{4}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{4}}_{\mathrm{d}} = \num{0.0}$ \\
\end{center}

uzyksaliśmy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{3.2694} \\
    \num{6.4426} \\
    \num{3.3455}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości wyniósł $\bar{E} = \num{10.531}$\\

Dodanie członu całkującego przyniosło bardzo duże korzyści, jeśli chodzi o jakość regulacji.
Wskaźniki jakości, a szczególnie $E_{\mathrm{2}}$, uległy znacznej poprawie. Udało się 
zmniejszyć amplitudę piku wartości drugiego wyjścia występującego w okolicach 56 próbki, jednak 
nie jest to jeszcze zadowalająca postać przebiegu.\\

Kolejną niepokojącą oznaką, jest przebieg sygnałów sterujących projektowanego regulatora.
Przebiegi sterowań zyskały lekki charakter oscylacyjny, w szczególności wejście trzecie jest 
sterowane w sposób pozostawiający wiele do życzenia. 

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Ti/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Ti/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Ti/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_2_out}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Ti/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}
    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_2_in}
\end{figure}
\FloatBarrier



Dla parametrów: \\
\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.0}$, $T^{\num{1}}_{\mathrm{i}} = \num{5.0}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{7.0}$, $T^{\num{3}}_{\mathrm{i}} = \num{12.0}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{3.0}$, $T^{\num{4}}_{\mathrm{i}} = \num{4.0}$, $T^{\num{4}}_{\mathrm{d}} = \num{0.1}$ \\
\end{center}

uzyksalismy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{4.8183} \\
    \num{2.4186} \\
    \num{3.2943}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości wyniósł $\bar{E} = \num{10.531}$\\

W kolejnej iteracji rozpoczęlismy dodawać do regulatora człon różniczkujący, jednocześnie 
modyfikując pozostałe 8 parametrów. Ostatecznie uzyskany regulator bardzo nieznacznie
korzysta z różniczkowania. Wskaźniki jakości regulacji polepszyły się w porównaniu do 
poprzednich prób. Jednocześnie udało się zlikwidować błędy poprzednika: piki wyjść zostały 
zminimalizowane a sygnał sterujący wygładził się i stracił charakter oscylacyjny.

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Td/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Td/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Td/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Td/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/dodanie_Td/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/dodanie_Td/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego}
        \label{pro_pid_2_out}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Td/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Td/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Td/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/dodanie_Td/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}
    \caption{Wejścia procesu wielowymiarowego}
    \label{pro_pid_2_in}
\end{figure}
\FloatBarrier

\subsubsection{Optymalizacja parametrów regulatora}

Dla omawianej struktury wielowymiarowego regulatora PID przeprowadziliśmy również proces 
strojenia regulatora metodą optymalizacji parametrów. Proces optymalizacji przeprowadziliśmy
przy pomocy skryptu \verb+pid_optim.m+. W wyniku działania skryptu uzyskaliśmy następujący 
szereg parametrów:\\

\begin{center}
    $K^{\num{1}}_{\mathrm{p}} = \num{1.2189}$, $T^{\num{1}}_{\mathrm{i}} = \num{3.5174}$, $T^{\num{1}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{2}}_{\mathrm{p}} = \num{0.0}$, $T^{\num{2}}_{\mathrm{i}} = \infty$, $T^{\num{2}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{3}}_{\mathrm{p}} = \num{7.3684}$, $T^{\num{3}}_{\mathrm{i}} = \num{11.301}$, $T^{\num{3}}_{\mathrm{d}} = \num{0.0}$ \\
    $K^{\num{4}}_{\mathrm{p}} = \num{2.4987}$, $T^{\num{4}}_{\mathrm{i}} = \num{3.556}$, $T^{\num{4}}_{\mathrm{d}} = \num{0.14004}$ \\
\end{center}

W symulacji procesu regulowanego, dla tego zestawu parametrów uzyksalismy następujące wskaźniki jakości:\\

\[
\begin{bmatrix}
    E_{\mathrm{1}} \\
    E_{\mathrm{2}} \\
    E_{\mathrm{3}} 
\end{bmatrix}
= 
\begin{bmatrix}
    \num{3.5602} \\
    \num{2.8595} \\
    \num{3.7186}
\end{bmatrix}
\]

Sumaryczny wskaźnik jakości wyniósł $\bar{E} = \num{10.138}$. Uzyskane wyniki są zbliżone 
do tych uzyskanych ręcznie. 

%% wyjscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=7cm,
                    xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                    xlabel={$k$},
                    ylabel={$y_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$y_{\mathrm{1}}[k]$},
                    \addlegendentry{$y_{\mathrm{1}}^{\mathrm{zad}}[k]$},
                
                    \addlegendimage{no markers,red}
                    \addlegendimage{no markers,blue}
                
                    \addplot[red, semithick] file{../data/project/zad4/pid/pid_optim/output_1.csv};  
                    \addplot[blue, semithick] file{../data/project/zad4/pid/pid_optim/stpt_1.csv};
                    
                    \end{axis}
            \end{tikzpicture}
        }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{2}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{2}}[k]$},
                        \addlegendentry{$y_{\mathrm{2}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/pid_optim/output_2.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/pid_optim/stpt_2.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}

        \begin{subfigure}[b]{\textwidth}
            \centering
            \resizebox{\linewidth}{!}{
                \begin{tikzpicture}
                    \begin{axis}[
                        width=0.98\textwidth,
                        height=7cm,
                        xmin=0.0,xmax=1000,ymin=-0.5,ymax=2,
                        xlabel={$k$},
                        ylabel={$y_{\mathrm{3}}[k]$},
                        legend pos=south east,
                        y tick label style={/pgf/number format/1000 sep=},
                        ] 
                        \addlegendentry{$y_{\mathrm{3}}[k]$},
                        \addlegendentry{$y_{\mathrm{3}}^{\mathrm{zad}}[k]$},
                    
                        \addlegendimage{no markers,red}
                        \addlegendimage{no markers,blue}
                    
                        \addplot[red, semithick] file{../data/project/zad4/pid/pid_optim/output_3.csv};  
                        \addplot[blue, semithick] file{../data/project/zad4/pid/pid_optim/stpt_3.csv};
                        
                        \end{axis}
                \end{tikzpicture}
            }
        \end{subfigure}
        \caption{Wyjścia procesu wielowymiarowego sterowanego regulatorem z parametrami wyznaczonymi
        w drodze optymalizacji}
        \label{pro_pid_2_out}
\end{figure}

%% wejscia 

\begin{figure}
    \centering
    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{1}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{1}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/pid_optim/input_1.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{2}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{2}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/pid_optim/input_2.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{3}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{3}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/pid_optim/input_3.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}

    \begin{subfigure}[b]{\textwidth}
        \centering
        \resizebox{\linewidth}{!}{
            \begin{tikzpicture}
                \begin{axis}[
                    width=0.98\textwidth,
                    height=6cm,
                    xmin=0.0,xmax=1000,ymin=-3,ymax=3,
                    xlabel={$k$},
                    ylabel={$u_{\mathrm{4}}[k]$},
                    legend pos=south east,
                    y tick label style={/pgf/number format/1000 sep=},
                    ] 
                    \addlegendentry{$u_{\mathrm{4}}[k]$},
                    \addlegendimage{no markers,blue}
                    \addplot[const plot, blue, semithick] file{../data/project/zad4/pid/pid_optim/input_4.csv};  
                \end{axis}
            \end{tikzpicture}
        }
    \end{subfigure}
    \caption{Wejścia procesu wielowymiarowego sterowanego regulatorem z parametrami wyznaczonymi
    w drodze optymalizacji}
    \label{pro_pid_2_in}
\end{figure}
\FloatBarrier

